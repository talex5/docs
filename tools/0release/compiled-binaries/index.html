<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/logo.png">
  
  <title>Compiled binaries - Zero Install</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../../style.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Compiled binaries";
    var mkdocs_page_input_path = "tools/0release/compiled-binaries.md";
    var mkdocs_page_url = "/tools/0release/compiled-binaries/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Zero Install</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">About</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../comparison/">Comparison</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../features/">Features</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../perspectives/">Perspectives</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../troubleshooting/">Trouble-shooting</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Basics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../basics/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../basics/first-launch/">First launch</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../basics/making-shortcuts/">Making shortcuts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../basics/using-apps/">Using apps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../basics/windows/">Desktop integration</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Details</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../details/">Manual walk-through</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/cache/">Cache and sharing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/cli/">Command-line interface</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/distribution-integration/">Distribution integration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/export/">Export</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/file-locations/">File locations</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/os-differences/">OS-specific differences</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/policy-settings/">Policy settings</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/security/">Security</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/servers/">Servers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/sharing/">Sharing downloads between users</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/sync/">Sync</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/virtual-machines/">Virtual machines</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../details/windows/">Zero Install for Windows</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developers</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../developers/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../developers/design/">Design</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../developers/dotnet-api/">.NET API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../developers/json-api/">JSON API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../developers/python-api/">Python API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../developers/solver/">The Solver</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../developers/using-git/">Using Git</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Packaging</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../packaging/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../packaging/concepts/">Concepts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../packaging/guide-cli/">Packaging guide (command-line)</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../packaging/guide-gui/">Packaging guide (graphical)</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../packaging/local-feeds/">Local feeds</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../packaging/templates/">Templates</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Examples</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../packaging/examples/dotnet-lib/">.NET library</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../packaging/examples/find/">Find</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../packaging/examples/inkscape/">Inkscape</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../packaging/examples/rox/">ROX-Filer</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Specifications</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../specifications/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../specifications/capabilities/">Capabilities extension</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../specifications/catalog/">Catalog files</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../specifications/feed/">Feed files</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../specifications/manifest/">Manifest files</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../specifications/selections/">Selections files</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tools</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0bootstrap/">0bootstrap</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0compile/">0compile</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0export/">0export</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0mirror/">0mirror</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0publish-win/">0publish-win</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0publish/">0publish</a>
                </li>
                <li class="">
                    
    <a class="" href="../">0release</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0repo/">0repo</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0share/">0share</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0template/">0template</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0test/">0test</a>
                </li>
                <li class="">
                    
    <a class="" href="../../0watch/">0watch</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ebox/">ebox</a>
                </li>
                <li class="">
                    
    <a class="" href="../../feedlint/">FeedLint</a>
                </li>
                <li class="">
                    
    <a class="" href="../../make-headers/">Make-headers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../pkg2zero/">pkg2zero</a>
                </li>
                <li class="">
                    
    <span class="caption-text">0compile</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../0compile/chroot-build/">Chroot build</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../0compile/developers/">Developers</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../0compile/example-scons/">Example: SCons</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">0release</span>
    <ul class="subnav">
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">Compiled binaries</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#releases-with-source-and-binary-packages">Releases with source and binary packages</a></li>
    

    <li class="toctree-l4"><a href="#compiling-on-multiple-systems">Compiling on multiple systems</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#the-build-command">The build command</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#setting-up-a-vagrant-build-slave">Setting up a Vagrant build slave</a></li>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../customisation/">Customisation</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Zero Install</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>0release &raquo;</li>
        
      
        
          <li>Tools &raquo;</li>
        
      
    
    <li>Compiled binaries</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/0install/docs/edit/master/docs/tools/0release/compiled-binaries.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="releases-with-source-and-binary-packages">Releases with source and binary packages</h1>
<p><a href="../">0release</a> can be used to create releases of your software from a version control system. The main page described how to make releases of programs which are architecture-independent (e.g. programs written in Python) where a single package is produced. This page explains what happens for programs which must be compiled for different architectures (e.g. C programs).</p>
<p>The extended release process looks like this:</p>
<p><img alt="The release process with binary packages" src="../../../img/uml/release-process-binaries.png" /></p>
<p>TODO: 0release doesn't currently unit-test the binaries it produces</p>
<p>After generating an archive and a feed for the source code release candidate (where <code>arch='*-src'</code>), 0release also compiles a binary for the host system (using <a href="../../0compile/">0compile</a>). It uploads both the source and binary archive and publishes both in the Zero Install feed.</p>
<p>For an example of a simple binary package that works this way, have a look at the <a href="http://repo.or.cz/w/0release.git?a=blob;f=tests/c-prog.tgz;h=ae1f06864c70f65fdef5a00065fb82eec809d6dc;hb=a7bce06b6494407b2d80124c65f13493e3b44378">c-prog.tgz</a> package in 0release's tests directory:</p>
<pre><code class="shell">$ tar xzf c-prog.tgz
$ mkdir release-c-prog
$ cd release-c-prog
$ 0launch http://0install.net/2007/interfaces/0release.xml ../c-prog/c-prog.xml
</code></pre>

<h1 id="compiling-on-multiple-systems">Compiling on multiple systems</h1>
<p>To build binaries for multiple architectures, you'll need to create a configuration file listing the available <em>builders</em>. 0release uses the <a href="http://www.freedesktop.org/wiki/Specifications/basedir-spec">Base Directory Specification</a> to find its configuration files; with the default settings, you need to create the file <code>~/.config/0install.net/0release/builders.conf</code>.</p>
<p>The <code>builders.conf</code> file has a <code>[global]</code> section listing the builders to use, followed by one section for each builder. Each builder can have three commands specified: one to start the builder (optional), one the actually do the build, and one to shutdown the builder (optional). Here is an example configuration:</p>
<pre><code class="ini">[global]
builders = host, freebsd

[builder-host]
build = 0launch http://0install.net/2007/interfaces/0release.xml --build-slave &quot;$@&quot;

[builder-precise32]
build = build-on-vm precise32-build-slave
</code></pre>

<p>This defines two builders named <code>host</code> and <code>precise32</code>. <code>host</code> simply runs 0release in build-slave mode on the local machine (in fact, you don't need to specify this section because it exists by default). The <code>precise32</code> builder run a script (see <a href="#setting-up-a-vagrant-build-slave">below</a>) to bring up a VirtualBox virtual machine, submit the build to it, and then shut it down again.</p>
<h2 id="the-build-command">The build command</h2>
<p>The build command is called with four arguments:</p>
<ol>
<li>The name of the generated XML feed file for the source release candidate.</li>
<li>The name of the generated source archive.</li>
<li>The URL of the directory where the release will be hosted eventually.</li>
<li>The name of the binary feed to be generated.</li>
</ol>
<p>The three names are of files in the current directory without the directory part; this simplifies the copying. The build command must do three things:</p>
<ol>
<li>Copy the input files (the source feed and archive) to the build system.</li>
<li>Invoke <code>0release --build-slave</code> to do the build.</li>
<li>Copy the results (the binary feed and archive) back to the local system.</li>
</ol>
<h1 id="setting-up-a-vagrant-build-slave">Setting up a Vagrant build slave</h1>
<p>First, we'll need to create a "box" with the build system. <a href="http://docs.vagrantup.com/">Create a Vagrantfile</a> for the new box, e.g.</p>
<pre><code class="vagrant">Vagrant::Config.run do |config|
  config.vm.box = &quot;precise32&quot;
  config.vm.box_url = &quot;http://files.vagrantup.com/precise32.box&quot;
end
</code></pre>

<p>The bring the machine up and install the basic build environment. The only package required by 0release is 0install itself, but you must also install any system packages that are needed by the software to be built (i.e. those which can't be installed by 0install automatically):</p>
<pre><code class="shell">$ vagrant up
$ vagrant ssh -c 'sudo apt-get update &amp;&amp; 
    sudo apt-get install -y zeroinstall-injector build-essential &amp;&amp;
    mkdir -p ~vagrant/.cache/0install.net'
</code></pre>

<p>Now package the VM into a new box and add it. You might wish to create a <code>Vagrantfile.pkg</code> to enable a shared 0install cache (see <a href="../../../details/virtual-machines/#vagrant">Virtual Machines / Vagrant</a>).</p>
<pre><code class="shell">$ vagrant package --vagrantfile Vagrantfile.pkg
$ vagrant box add precise32-build-slave package.box
</code></pre>

<p>Create the <code>build-on-vm</code> script, make it executable, and place it in your <code>$PATH</code> (on the host):</p>
<pre><code class="shell">#!/bin/bash
set -eux

if `[ -f Vagrantfile \]; then
  vagrant destroy -f &amp;&amp; rm Vagrantfile
fi

vagrant init &quot;$1&quot;
shift
vagrant up
vagrant ssh-config &gt; .ssh-config
ssh -F .ssh-config default \
  'cd /vagrant &amp;&amp; 0launch --not-before 0.10 \
     http://0install.net/2007/interfaces/0release.xml \
     --build-slave &quot;$@&quot;' &quot;$@&quot; &amp;&amp; \
  vagrant destroy -f &amp;&amp; rm Vagrantfile
</code></pre>

<p>You can then use it in your <code>builders.conf</code>, as above.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../customisation/" class="btn btn-neutral float-right" title="Customisation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../0compile/example-scons/" class="btn btn-neutral" title="Example: SCons"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/0install/docs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../0compile/example-scons/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../customisation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../menu.js" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
